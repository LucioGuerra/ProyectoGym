<app-drawer>
  <ng-container main-content>
    <span class="mainPage">
      <mat-card class="tarjeta">
        <mat-card-header>
          <div class="header">
            <button mat-icon-button class="back-btn" aria-label="Go back" (click)="homePage()">
              <mat-icon>chevron_left</mat-icon>
            </button>

            <div class="avatar-container">
              <div class="user-avatar">
                <img class="user-avatar-img" [src]="userImage" alt="User Image">
              </div>
            </div>

            <div class="role-container">
              <mat-button-toggle-group
                name="role"
                aria-label="role"
                [(ngModel)]="user.role" required>
                
                @for (role of roles; track $index) {
                  <mat-button-toggle [value]="role" (click)="changeRole(role)">
                    {{ role.toLowerCase() }}
                  </mat-button-toggle>
                }
                
                
              </mat-button-toggle-group>
            </div>
          </div>
        </mat-card-header>

        <mat-divider class="divisor"></mat-divider>

        <mat-card-content>
          <form [formGroup]="form" (ngSubmit)="saveChanges()">
            <div class="user-content">


            <div class="fila common-rows" id="fila1">

              <mat-form-field>
                <mat-label>First Name</mat-label>
                <input matInput id="firstName" type="text" formControlName="firstName" [errorStateMatcher]="matcher"/>
              
                @if ("form.get('firstName')?.hasError('required') && (form.get('firstName')?.touched || form.get('firstName')?.dirty") {
                  <mat-error>
                    First name is required
                  </mat-error>
                }
              </mat-form-field>
              

              <mat-form-field>
                <mat-label> Surname</mat-label>
                <input matInput id="lastName" type="text" formControlName="lastName" [errorStateMatcher]="matcher"/>
              
                @if ("form.get('lastName')?.hasError('required') && (form.get('lastName')?.touched || form.get('lastName')?.dirty") {
                  <mat-error>
                     Surname is required
                  </mat-error>
                }
              </mat-form-field>

            </div>


            <div class="fila common-rows" id="fila2">

              <mat-form-field>
                <mat-label> DNI</mat-label>
                <input matInput id="dni" type="text" formControlName="dni" [errorStateMatcher]="matcher"/>
              
                @if ("form.get('dni')?.hasError('required') && (form.get('dni')?.touched") {
                  <mat-error>
                     DNI is required
                  </mat-error>
                }

              </mat-form-field>

              
              <mat-form-field>
                
                <mat-label>Email</mat-label>
                <input matInput id="email" type="text" formControlName="email" [errorStateMatcher]="matcher"/>

              </mat-form-field>

            </div>


            <div class="fila common-rows" id="fila3">


              <mat-form-field>
                <mat-label>Mobile</mat-label>
                <input matInput id="phone" type="text" formControlName="phone" [errorStateMatcher]="matcher"/>
              
                @if ("form.get('phone')?.hasError('required') && (form.get('phone')?.touched || form.get('phone')?.dirty") {
                  <mat-error>
                     Mobile is required
                  </mat-error>
                }
              </mat-form-field>


              <div id="special-column">
                <button mat-raised-button color="primary" (click)="PasswordChange()">
                  Change password
                  <mat-icon class="icon-right">chevron_right</mat-icon>
                </button>
            </div>


            </div>

            <div class="fila common-rows" id="fila4">

              <button mat-button class="custom-button" type="submit">
                Save
              </button>
              
            </div>

           </div>
          </form>
        </mat-card-content>
      </mat-card>
    </span>
  </ng-container>
</app-drawer>
